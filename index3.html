<!DOCTYPE html>
<html>
<head></head>
<body>

<h1 style='text-align: center; margin-bottom: -35px;'>On the way to self-respect webapp</h1>
  <br><br>

	
<!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/div -->
<!-- https://CodeSolutions2.github.io/on_the_way_to_selfrespect/index2.html -->

<button id="run_it_button" onclick="run_it()" style="display:block">run_it</button>

	
<style>
      canvas {border: 1px solid black;}
    </style>
	
  
  <script>

// -------------------------------------------------

var squarelocation = [0, 1, 2, 3, 4, 5, 6];
	  
// Set the width and height of the canvas
var canvasElement_width = 150;
var canvasElement_height = canvasElement_width;
	  
// ----------------------------
// Create all the elements
// ----------------------------
var canvasElement0 = document.createElement('canvas');
var ctx0 = canvasElement0.getContext("2d");  // Get the 2D rendering context of the canvas

var canvasElement1 = document.createElement('canvas');
var ctx1 = canvasElement1.getContext("2d");

var canvasElement2 = document.createElement('canvas');
var ctx2 = canvasElement2.getContext("2d");  // Get the 2D rendering context of the canvas

var canvasElement3 = document.createElement('canvas');
var ctx3 = canvasElement3.getContext("2d");  // Get the 2D rendering context of the canvas

var canvasElement4 = document.createElement('canvas');
var ctx4 = canvasElement4.getContext("2d");  // Get the 2D rendering context of the canvas

var canvasElement5 = document.createElement('canvas');
var ctx5 = canvasElement5.getContext("2d");  // Get the 2D rendering context of the canvas

var canvasElement6 = document.createElement('canvas');
var ctx6 = canvasElement6.getContext("2d");  // Get the 2D rendering context of the canvas

// -------------------------------------------------

async function initialization_of_canvasElements() {

	canvasElement0.width = canvasElement_width;
	canvasElement0.height = canvasElement_height;
	canvasElement1.width = canvasElement_width;
	canvasElement1.height = canvasElement_height;
	canvasElement2.width = canvasElement_width;
	canvasElement2.height = canvasElement_height;
	canvasElement3.width = canvasElement_width;
	canvasElement3.height = canvasElement_height;
	canvasElement4.width = canvasElement_width;
	canvasElement4.height = canvasElement_height;
	canvasElement5.width = canvasElement_width;
	canvasElement5.height = canvasElement_height;
	canvasElement6.width = canvasElement_width;
	canvasElement6.height = canvasElement_height;

	// Location style: row
	canvasElement0.style.left = Number(0*canvasElement_width + 40)+'px';
	canvasElement1.style.left = Number(1*canvasElement_width + 40)+'px';
	canvasElement2.style.left = Number(2*canvasElement_width + 40)+'px';
	canvasElement3.style.left = Number(3*canvasElement_width + 40)+'px';
	canvasElement4.style.left = Number(4*canvasElement_width + 40)+'px';
	canvasElement5.style.left = Number(5*canvasElement_width + 40)+'px';
	canvasElement6.style.left = Number(6*canvasElement_width + 40)+'px';

	// Location sytle: triangle
	// Location sytle: square
	// Location sytle: 5 sides
	// Location sytle: hexagon
	// Location style: 7 sides

	// Add the canvas to the document body or any other desired element
	document.body.appendChild(canvasElement0);
	document.body.appendChild(canvasElement1);
	document.body.appendChild(canvasElement2);
	document.body.appendChild(canvasElement3);
	document.body.appendChild(canvasElement4);
	document.body.appendChild(canvasElement5);
	document.body.appendChild(canvasElement6); 

	// Make all the canvas context objects a certain initial color
	ctx0.fillStyle = '#999c98';  // Background square over image = blue
	ctx0.fillRect(0, 0, canvasElement_width, canvasElement_height);
	ctx1.fillStyle = '#999c98';  // Background square over image = blue
	ctx1.fillRect(0, 0, canvasElement_width, canvasElement_height);
	ctx2.fillStyle = '#999c98';  // Background square over image = blue
	ctx2.fillRect(0, 0, canvasElement_width, canvasElement_height);
	ctx3.fillStyle = '#999c98';  // Background square over image = blue
	ctx3.fillRect(0, 0, canvasElement_width, canvasElement_height);
	ctx4.fillStyle = '#999c98';  // Background square over image = blue
	ctx4.fillRect(0, 0, canvasElement_width, canvasElement_height);
	ctx5.fillStyle = '#999c98';  // Background square over image = blue
	ctx5.fillRect(0, 0, canvasElement_width, canvasElement_height);
	ctx6.fillStyle = '#999c98';  // Background square over image = blue
	ctx6.fillRect(0, 0, canvasElement_width, canvasElement_height);
}


	  
	  
async function run_it() {

	// -------------------------------------------------
	
	// await initialization_of_canvasElements();

	// Select difficulty: difficulity can be from 0 to 6, here it is 3 so only 3 squares flash 
	// Randomly permute squarelocation
	// let order = await rand_perm(squarelocation, 3);
	// console.log('order: ', order);

	// await flash_sequence(order);
		      
	// -------------------------------------------------

	// OR

	// await initialization_of_canvasElements().then(async () => {
	// 		let order = await rand_perm(squarelocation, 2); console.log('order: ', order); return order;
	// 	}).then(async function(order) { await flash_sequence(order);
		// });

	// -------------------------------------------------

	// OR

	await initialization_of_canvasElements().
		then(async () => {let order = await rand_perm(squarelocation, 2); console.log('order: ', order); return order;}).
		then(async function(order) { 
		  order.forEach(async function(val, index) { console.log('val: ', val);
		  await show_one_image_square(val).then(async (val) => { await new Promise(r => setTimeout(r, 2000)); return val;
			}).then(async function(val) { await show_one_grey_square(val);
			}).then(async () => { await new Promise(r => setTimeout(r, 3000)); });
	
		});  // end of order.forEach
			
		});
	
	// -------------------------------------------------
	
}  // end of run_it

// -------------------------------------------------


async function rand_perm(x, vec_len) {

	out = [];
	while (out.length != vec_len) {
	   let y = Math.round(x.length*Math.random());
		if (out.includes(y) == false){
			out.push(y);
		}
	}
	return out;
	
}  // end of rand_perm
	  
// -------------------------------------------------

async function flash_sequence(order){

	order.forEach(async function(val, index) {

	  console.log('val: ', val);
		
	  await show_one_image_square(val).then(async (val) => { await new Promise(r => setTimeout(r, 2000)); return val;
		}).then(async function(val) { await show_one_grey_square(val);
		}).then(async () => { await new Promise(r => setTimeout(r, 3000)); });

	});  // end of order.forEach
} 

	  
// -------------------------------------------------
	  
async function show_one_image_square(val) {
	
	    const image = new Image();
	
	    image.setAttribute('crossOrigin', "");
	    image.setAttribute('headers', {"Content-Type": "application/json", "Access-Control-Allow-Origin": "*"});
	    
	    if (val == 0) {
		image.onload = async () => { ctx0.drawImage(image, 0,0); };  // end of image.onload
		image.src = "https://storage.googleapis.com/on-the-way2selfrespect/red.png";
	    } else if (val == 1) {
		image.onload = async () => { ctx1.drawImage(image, 0,0); };  // end of image.onload
		image.src = "https://storage.googleapis.com/on-the-way2selfrespect/green.png";
	    } else if (val == 2) {
		
		image.onload = async () => { ctx2.drawImage(image, 0,0); };  // end of image.onload
		    image.src = "https://storage.googleapis.com/on-the-way2selfrespect/blue.png";
	    } else if (val == 3) {
		
		image.onload = async () => { ctx3.drawImage(image, 0,0); };  // end of image.onload
		    image.src = "https://storage.googleapis.com/on-the-way2selfrespect/cyan.png";
	    } else if (val == 4) {
		
		image.onload = async () => { ctx4.drawImage(image, 0,0); };  // end of image.onload
		    image.src = "https://storage.googleapis.com/on-the-way2selfrespect/yellow.png";
	    } else if (val == 5) {
		image.onload = async () => { ctx5.drawImage(image, 0,0); };  // end of image.onload
		image.src = "https://storage.googleapis.com/on-the-way2selfrespect/magenta.png";
	    } else {
		image.onload = async () => { ctx6.drawImage(image, 0,0); };  // end of image.onload
		image.src = "https://storage.googleapis.com/on-the-way2selfrespect/orange.png";
	    }
		    
	    

	// image.src = url;
  
}  // end of main

// -------------------------------------------------



async function show_one_grey_square(val) {
	
    // Draw image on canvas
    if (val == 0) {
	ctx0.fillStyle = '#999c98';  // Background square over image = blue
	ctx0.fillRect(0, 0, canvasElement_width, canvasElement_height);
    } else if (val == 1) {
	ctx1.fillStyle = '#999c98';  // Background square over image = blue
	ctx1.fillRect(0, 0, canvasElement_width, canvasElement_height);
    } else if (val == 2) {
	ctx2.fillStyle = '#999c98';  // Background square over image = blue
	ctx2.fillRect(0, 0, canvasElement_width, canvasElement_height);
    } else if (val == 3) {
	ctx3.fillStyle = '#999c98';  // Background square over image = blue
	ctx3.fillRect(0, 0, canvasElement_width, canvasElement_height);
    } else if (val == 4) {
	ctx4.fillStyle = '#999c98';  // Background square over image = blue
	ctx4.fillRect(0, 0, canvasElement_width, canvasElement_height);
    } else if (val == 5) {
	ctx5.fillStyle = '#999c98';  // Background square over image = blue
	ctx5.fillRect(0, 0, canvasElement_width, canvasElement_height);
    } else {
	ctx6.fillStyle = '#999c98';  // Background square over image = blue
	ctx6.fillRect(0, 0, canvasElement_width, canvasElement_height);
    }
	
}  // end of show_grey_square

	  
// -------------------------------------------------

	  
async function create_dynamic_canvasElement(index) {
	
	// Create a canvas element
	var canvasElement = document.createElement('canvas');

	canvasElement.width = canvasElement_width;
	canvasElement.height = canvasElement_height;
	
	// Get the 2D rendering context of the canvas
	var ctx = canvasElement.getContext("2d");
	
	if (index == 0) {
		canvasElement.style.left = 40+'px';
	} else {
		let tot = index*canvasElement.width + 40;
		canvasElement.style.left = tot+'px';
	}
  
	// Add the canvas to the document body or any other desired element
	document.body.appendChild(canvasElement);

	return ctx;
}

// -------------------------------------------------

	
</script>
</body>
</html>
